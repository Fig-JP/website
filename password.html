<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ç”Ÿæˆå™¨ | ToolBox</title>
    <link rel="stylesheet" href="css/common.css">
    <style>
        /* ãƒ†ãƒ¼ãƒ: ãƒ€ãƒ¼ã‚¯ */
        body {
            background: #0f172a;
            color: #e2e8f0;
        }
        
        nav {
            background: rgba(30, 41, 59, 0.95);
            border-bottom: 1px solid #334155;
            box-shadow: 0 2px 20px rgba(0,0,0,0.3);
        }
        
        .logo {
            color: #38bdf8;
        }
        
        .nav-links a {
            color: #94a3b8;
        }
        
        .nav-links a:hover,
        .nav-links a.active {
            color: #38bdf8;
        }
        
        .nav-links a::after {
            background: #38bdf8;
        }
        
        .container {
            background: #1e293b;
            border: 1px solid #334155;
            border-radius: 16px;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
            /* common.cssã®è¨­å®šã‚’ä¸Šæ›¸ã */
            padding: 30px !important;
            max-width: 600px !important;
            margin: 40px auto !important;
        }
        
        h1 {
            color: #f8fafc;
        }
        
        .subtitle {
            color: #94a3b8;
        }
        
        .settings {
            background: #0f172a;
            border: 1px solid #334155;
        }
        
        .setting-label {
            color: #cbd5e1;
        }
        
        input[type="range"] {
            background: #334155;
        }
        
        input[type="range"]::-webkit-slider-thumb {
            background: #38bdf8;
        }
        
        .length-value {
            color: #38bdf8;
        }
        
        .toggle-slider {
            background: #334155;
        }
        
        input:checked + .toggle-slider {
            background: #38bdf8;
        }
        
        .result-box {
            background: #0f172a;
            border: 2px solid #334155;
        }
        
        .result {
            color: #38bdf8;
        }
        
        .result-placeholder {
            color: #64748b;
        }
        
        .strength-bar {
            background: #334155;
        }
        
        .strength-text {
            color: #94a3b8;
        }
        
        .strength-weak { background: #ef4444; }
        .strength-fair { background: #f59e0b; }
        .strength-good { background: #3b82f6; }
        .strength-strong { background: #10b981; }
        
        .btn-primary {
            background: #38bdf8;
            color: #0f172a;
        }
        
        .btn-primary:hover {
            background: #7dd3fc;
        }
        
        .btn-secondary {
            background: #334155;
            color: #e2e8f0;
        }
        
        .btn-secondary:hover {
            background: #475569;
        }
        
        .history-section {
            border-color: #334155;
        }
        
        .history-title {
            color: #94a3b8;
        }
        
        .clear-btn {
            color: #64748b;
        }
        
        .clear-btn:hover {
            color: #94a3b8;
        }
        
        .history-item {
            background: #0f172a;
            border: 1px solid #334155;
        }
        
        .history-pwd {
            color: #38bdf8;
        }
        
        .btn-copy {
            background: #334155;
            color: #e2e8f0;
        }
        
        .btn-copy:hover {
            background: #475569;
        }
        
        .tips {
            background: #0f172a;
            border-left: 4px solid #38bdf8;
            padding: 15px 20px;
            margin-top: 20px;
        }
        
        .tips-title {
            color: #38bdf8;
        }
        
        .tips-list {
            color: #94a3b8;
            padding-left: 24px;
            margin-top: 8px;
        }
        
        .toast {
            background: #10b981;
        }
        
        footer {
            color: rgba(255,255,255,0.6);
        }
        
        footer a {
            color: #38bdf8;
            border-color: rgba(56, 189, 248, 0.5);
        }
    </style>
</head>
<body>
    <nav>
        <div class="nav-container">
            <a href="index.html" class="logo">ğŸ› ï¸ ToolBox</a>
            <ul class="nav-links">
                <li><a href="index.html">Home</a></li>
                <li><a href="random.html">æ–‡å­—ç”Ÿæˆ</a></li>
                <li><a href="password.html" class="active">ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰</a></li>
                <li><a href="about.html">About</a></li>
            </ul>
        </div>
    </nav>
    
    <div class="container">
        <h1>ğŸ” ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ç”Ÿæˆå™¨</h1>
        <p class="subtitle">å®‰å…¨ã§å¼·åŠ›ãªãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ç¬é—´ç”Ÿæˆ</p>
        
        <div class="result-box">
            <div class="result" id="result">
                <span class="result-placeholder">ã€Œç”Ÿæˆã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ãã ã•ã„</span>
            </div>
            <div class="strength-bar">
                <div class="strength-fill" id="strength-fill"></div>
            </div>
            <div class="strength-text" id="strength-text">å¼·åº¦: -</div>
        </div>
        
        <div class="settings">
            <div class="setting-row">
                <span class="setting-label">æ–‡å­—æ•°</span>
                <div class="length-control">
                    <input type="range" id="length" min="8" max="32" value="16" oninput="updateLength(this.value)">
                    <span class="length-value" id="length-val">16</span>
                </div>
            </div>
            
            <div class="setting-row">
                <span class="setting-label">å¤§æ–‡å­— (A-Z)</span>
                <label class="toggle">
                    <input type="checkbox" id="upper" checked>
                    <span class="toggle-slider"></span>
                </label>
            </div>
            
            <div class="setting-row">
                <span class="setting-label">å°æ–‡å­— (a-z)</span>
                <label class="toggle">
                    <input type="checkbox" id="lower" checked>
                    <span class="toggle-slider"></span>
                </label>
            </div>
            
            <div class="setting-row">
                <span class="setting-label">æ•°å­— (0-9)</span>
                <label class="toggle">
                    <input type="checkbox" id="numbers" checked>
                    <span class="toggle-slider"></span>
                </label>
            </div>
            
            <div class="setting-row">
                <span class="setting-label">è¨˜å· (!@#$...)</span>
                <label class="toggle">
                    <input type="checkbox" id="symbols" checked>
                    <span class="toggle-slider"></span>
                </label>
            </div>
            
            <div class="setting-row">
                <span class="setting-label">ç´›ã‚‰ã‚ã—ã„æ–‡å­—ã‚’é™¤å¤–<br><small style="color:#64748b">(0, O, l, 1, I)</small></span>
                <label class="toggle">
                    <input type="checkbox" id="exclude-ambiguous" checked>
                    <span class="toggle-slider"></span>
                </label>
            </div>
        </div>
        
        <button class="btn btn-primary" onclick="generate()">âš¡ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ç”Ÿæˆ</button>
        <button class="btn btn-secondary" id="copy-btn" onclick="copyResult()" disabled>ğŸ“‹ ã‚³ãƒ”ãƒ¼</button>
        
        <div class="history-section" id="history-section" style="display:none;">
            <div class="history-header">
                <span class="history-title">ç”Ÿæˆå±¥æ­´</span>
                <button class="clear-btn" onclick="clearHistory()">ã‚¯ãƒªã‚¢</button>
            </div>
            <div class="history-list" id="history-list"></div>
        </div>
        
        <div class="tips">
            <div class="tips-title">ğŸ’¡ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®ãƒ’ãƒ³ãƒˆ</div>
            <ul class="tips-list">
                <li>12æ–‡å­—ä»¥ä¸Šã‹ã¤4ç¨®é¡ã®æ–‡å­—ã‚’æ··ãœã‚‹ã¨æœ€å¼·</li>
                <li>åŒã˜ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’è¤‡æ•°ã‚µã‚¤ãƒˆã§ä½¿ã„å›ã•ãªã„</li>
                <li>ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã®åˆ©ç”¨ã‚’æ¨å¥¨</li>
            </ul>
        </div>
    </div>
    
    <footer>
        <p>Created with â¤ï¸ by Fig | <a href="about.html">About Me</a></p>
    </footer>
    
    <div class="toast" id="toast">ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼</div>

    <script>
        const charSets = {
            upper: "ABCDEFGHIJKLMNOPQRSTUVWXYZ",
            lower: "abcdefghijklmnopqrstuvwxyz",
            numbers: "0123456789",
            symbols: "!@#$%^*()_+-=[]{}|;:,.?"  // < > & " ' ã‚’å‰Šé™¤
        };
        
        const ambiguous = "0O1lI";
        let history = [];
        let currentPassword = "";
        
        function updateLength(val) {
            document.getElementById('length-val').textContent = val;
        }
        
        function showToast(msg) {
            const toast = document.getElementById('toast');
            toast.textContent = msg;
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 2000);
        }
        
        function calculateStrength(password) {
            let score = 0;
            
            if (password.length >= 8) score += 0.5;
            if (password.length >= 12) score += 1;
            if (password.length >= 16) score += 1;
            if (password.length >= 20) score += 1;
            if (password.length >= 24) score += 0.5;
            
            const hasUpper = /[A-Z]/.test(password);
            const hasLower = /[a-z]/.test(password);
            const hasNumber = /[0-9]/.test(password);
            const hasSymbol = /[^A-Za-z0-9]/.test(password);
            
            const typeCount = [hasUpper, hasLower, hasNumber, hasSymbol].filter(Boolean).length;
            
            if (typeCount === 4) score += 2;
            else if (typeCount === 3) score += 1;
            else if (typeCount === 2) score += 0.5;
            else score -= 1;
            
            if (password.length < 12 && typeCount < 3) score -= 1;
            if (/(.)\1{2,}/.test(password)) score -= 0.5;
            
            return Math.max(0, Math.min(3, Math.floor(score)));
        }
        
        function getStrengthLabel(level) {
            const labels = ["å¼±ã„", "æ™®é€š", "è‰¯å¥½", "å¼·åŠ›"];
            const classes = ["strength-weak", "strength-fair", "strength-good", "strength-strong"];
            return { text: labels[level], className: classes[level], width: (level + 1) * 25 };
        }
        
        function generate() {
            const length = parseInt(document.getElementById('length').value);
            const useUpper = document.getElementById('upper').checked;
            const useLower = document.getElementById('lower').checked;
            const useNumbers = document.getElementById('numbers').checked;
            const useSymbols = document.getElementById('symbols').checked;
            const excludeAmbiguous = document.getElementById('exclude-ambiguous').checked;
            
            let chars = "";
            if (useUpper) chars += charSets.upper;
            if (useLower) chars += charSets.lower;
            if (useNumbers) chars += charSets.numbers;
            if (useSymbols) chars += charSets.symbols;
            
            if (chars === "") {
                showToast("âš ï¸ å°‘ãªãã¨ã‚‚1ç¨®é¡ã‚’é¸æŠã—ã¦ãã ã•ã„");
                return;
            }
            
            if (excludeAmbiguous) {
                for (let char of ambiguous) {
                    chars = chars.split(char).join('');
                }
            }
            
            let password = "";
            const required = [];
            if (useUpper) required.push(getRandomChar(charSets.upper, excludeAmbiguous));
            if (useLower) required.push(getRandomChar(charSets.lower, excludeAmbiguous));
            if (useNumbers) required.push(getRandomChar(charSets.numbers, excludeAmbiguous));
            if (useSymbols) required.push(getRandomChar(charSets.symbols, excludeAmbiguous));
            
            password = required.join('');
            
            while (password.length < length) {
                password += chars[Math.floor(Math.random() * chars.length)];
            }
            
            password = password.split('').sort(() => Math.random() - 0.5).join('');
            
            currentPassword = password;
            document.getElementById('result').textContent = password;
            document.getElementById('copy-btn').disabled = false;
            
            const strength = calculateStrength(password);
            const { text, className, width } = getStrengthLabel(strength);
            const fill = document.getElementById('strength-fill');
            fill.className = 'strength-fill ' + className;
            fill.style.width = width + '%';
            document.getElementById('strength-text').textContent = `å¼·åº¦: ${text} (${password.length}æ–‡å­—)`;
            
            addToHistory(password);
        }
        
        function getRandomChar(set, excludeAmbiguous) {
            let valid = set;
            if (excludeAmbiguous) {
                for (let char of ambiguous) {
                    valid = valid.split(char).join('');
                }
            }
            return valid[Math.floor(Math.random() * valid.length)];
        }
        
        function addToHistory(pwd) {
            history = history.filter(p => p !== pwd);
            history.unshift(pwd);
            if (history.length > 5) history = history.slice(0, 5);
            updateHistoryDisplay();
        }
        
        function updateHistoryDisplay() {
            const section = document.getElementById('history-section');
            const list = document.getElementById('history-list');
            
            if (history.length === 0) {
                section.style.display = 'none';
                return;
            }
            
            section.style.display = 'block';
            // HTMLã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã—ã¦è¡¨ç¤º
            list.innerHTML = history.map(pwd => `
                <div class="history-item">
                    <span class="history-pwd">${escapeHtml(pwd)}</span>
                    <div class="history-actions">
                        <button class="icon-btn btn-copy" onclick="copyText('${escapeJsString(pwd)}')" title="ã‚³ãƒ”ãƒ¼">ğŸ“‹</button>
                    </div>
                </div>
            `).join('');
        }
        
        function escapeHtml(text) {
            return text
                .replace(/&/g, '&amp;')
                .replace(/</g, '&lt;')
                .replace(/>/g, '&gt;')
                .replace(/"/g, '&quot;')
                .replace(/'/g, '&#039;');
        }
        
        function escapeJsString(text) {
            return text
                .replace(/\\/g, '\\\\')
                .replace(/'/g, "\\'")
                .replace(/"/g, '\\"')
                .replace(/\n/g, '\\n')
                .replace(/\r/g, '\\r');
        }
        
        function clearHistory() {
            history = [];
            document.getElementById('history-section').style.display = 'none';
        }
        
        function copyResult() {
            if (currentPassword) copyText(currentPassword);
        }
        
        function copyText(text) {
            navigator.clipboard.writeText(text).then(() => {
                showToast('ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼');
            }).catch(() => {
                const ta = document.createElement('textarea');
                ta.value = text;
                document.body.appendChild(ta);
                ta.select();
                document.execCommand('copy');
                document.body.removeChild(ta);
                showToast('ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼');
            });
        }
        
        generate();
    </script>
</body>
</html>